<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Weight Control</title>
        <link rel="stylesheet" href="styles.css">
        <script>
            // ฟังก์ชันสำหรับอัปเดตวันที่และเวลา
            function updateDateTime() {
                const now = new Date(); // วันที่และเวลาปัจจุบัน
                const options = { year: '2-digit', month: '2-digit', day: '2-digit' }; // รูปแบบวันที่
                const formattedDate = now.toLocaleDateString('en-GB', options); // แปลงวันที่
                const formattedTime = now.toLocaleTimeString('en-GB'); // แปลงเวลา
                // อัปเดตข้อความใน <p> ของ Sidebar
                document.getElementById('current-date-time').textContent = `${formattedDate} | ${formattedTime}`;
            }
            // เรียกฟังก์ชันอัปเดตทุกวินาที
            document.addEventListener("DOMContentLoaded", function() {
            setInterval(updateDateTime, 1000);
        
            let addUserBtn = document.getElementById("addUserBtn");
            if (addUserBtn) {
                addUserBtn.addEventListener("click", function() {
                    window.location.href = 'add_user_page.html'; // Replace with actual page path
                });
            }
        });
        </script>
    </head>
    <body>
        <!-- ส่วนหลักของเว็บ -->
        <div class="container">
            <!-- Sidebar -->
            <div class="sidebar">
                <h1>Weight</h1>
                <!-- วันที่และเวลาจะถูกอัปเดตที่นี่ -->
                <p id="current-date-time">Loading...</p>
                <div class="avatar-group">
                    <img class="avatar" alt="Cute Avatar">
                    <img class="avatar" alt="Cute Avatar">
                    <img class="avatar" alt="Cute Avatar">
                    <img class="avatar" alt="Cute Avatar">
                </div>
                <div class="code-id-form">
                    <label for="codeInput">CODE ID :</label>
                    <input type="text" id="codeId" name="codeId" readonly>
                    <div>
                        <label for="codeInput">STATUS. :</label>
                        <input type="text" id="Usertype" name="Usertype" readonly>
                    </div>
                </div>
                <div class="line-packing">
                    <h3>LINE Packing</h3>
                    <label><input type="radio" name="line"> TRIM</label>
                    <label><input type="radio" name="line"> SMALL TRIM</label>
                    <label><input type="radio" name="line"> PBP</label>
                    <label><input type="radio" name="line"> SMALL PANAL</label>
                    <label><input type="radio" name="line"> CH</label>
                    <label><input type="radio" name="line"> OTHER</label>
                </div>
                <div class="control-buttons">
                    <h3>CONTROL</h3>
                    <div class="button-container">
                        <!-- ปุ่ม 3 ตัวแรกชิดซ้าย -->
                        <div class="left-buttons">
                            <button id="newButton">New</button>
                            <button id="clearButton">Clear</button>
                            <button id="addUserButton" style="display:none;" disabled>Add User</button>
                        </div>
                        <!-- ปุ่ม 3 ตัวกลาง -->
                        <div class="center-buttons">
                            <button id="updateButton">Update</button>
                            <button id="queueOrderButton">Queue Order</button>
                            <button id="reportButton">Report</button>
                        </div>
                    </div>                    
                </div>
            </div>
            <!-- ส่วน Action และตารางข้อมูล -->
            <div class="main-content">
                <div class="action-section">
                    <div class="action-circles">
                        <div class="circle"></div>
                        <div class="circle"></div>
                        <div class="circle"></div>
                        <div class="action-text">Action</div>
                    </div>
                    <div class="part-no">
                        <label for="partNoInput">Part No :</label>
                        <input type="text" id="partNoInput" placeholder="Enter Part No." />
                    </div>
                </div>
                <div class="part-action">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="Part-action1">Part No :</label>
                            <input type="text" id="Part-action1" placeholder="Enter Part No." readonly>
                        </div>
                        <div class="form-group">
                            <label for="Part-action2">Control No :</label>
                            <input type="text" id="Part-action2" placeholder="Enter Control No." readonly>
                        </div>
                        <div class="form-group">
                            <label for="Part-action3">Part Q'TY :</label>
                            <input type="text" id="Part-action3" placeholder="Enter Q'TY" readonly>
                        </div>
                        <div class="form-group">
                            <label for="Part-action4">By Piece:</label>
                            <input type="text" id="Part-action4" placeholder="Enter Part by Piece" readonly>
                        </div>
                        <div class="form-group">
                            <label for="Part-action5">Part Name :</label>
                            <input type="text" id="Part-action5" placeholder="Enter Part Name" readonly>
                        </div>
                        <div class="form-group">
                            <label for="Part-action6">Model :</label>
                            <input type="text" id="Part-action6" placeholder="Enter Model" readonly>
                        </div>
                        <div class="form-group">
                            <label>100% :</label>
                            <div class="radio-group">
                                <label><input type="radio" name="hundredPercent" disabled> :Yes</label>
                                <label><input type="radio" name="hundredPercent" disabled> : No</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="Part-action7">Percent :</label>
                            <input type="text" id="Part-action7" placeholder="Enter Percent" readonly>
                            <input type="text" id="Part-action8" placeholder="Enter Percent" readonly>
                        </div>
                    </div>
                    <div class="main-container">
                        <!-- ส่วนที่ 1: Detail Part -->
                          <div class="table-container">
                            <h3 class="section-header">Detail Part</h3>
                            <option value="" disabled selected>No.  | D/C Part No. | Full Part Name. | Model | Control | Total </option>
                            <select id="detailPart" class="listbox" size="9"></select>
                              <script>
                                  function fetchData() {
                                    fetch("https://script.google.com/macros/s/AKfycbymuOcyRV_rMWLEW-y0qqIFbU7kejTmimaVQNztG_oUbp89n8Orodix-EoqxHF2OguY/exec")
                                      .then(response => response.json())
                                      .then(data => displayData(data))
                                      .catch(error => console.error("Error fetching data:", error));
                                  }
                                
                                  function displayData(data) {
                                    let listbox = document.getElementById("detailPart");
                                    listbox.innerHTML = `<option value="" disabled selected>No.  | D/C Part No. | Full Part Name. | Model | Control | Total</option>`;
                                
                                    data.forEach((row, index) => {
                                      let option = document.createElement("option");
                                      option.value = index + 2; // กำหนดค่าเป็นเลขแถว (เริ่มที่แถว 2)
                                      option.textContent = `${row["Column A"]} | ${row["Column B"]} | ${row["Column C"]} | ${row["Column D"]} | ${row["Column E"]} | ${row["Column F"]}`;
                                      listbox.appendChild(option);
                                    });
                                  }
                                
                                  // โหลดข้อมูลเมื่อหน้าเว็บเปิด
                                  window.onload = fetchData;
                              </script>

                            <div id="actions">
                              <button id="edit-btn" onclick="editFunction()">Edit</button>
                              <button id="delete-btn" onclick="deleteFunction()">Delete</button>
                            </div>
                          </div>
                        <!-- ส่วนที่ 2: Check Weight -->
                        <div class="check-weight-section">
                            <h3 class="section-header">Weight</h3>
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th>Standard</th>
                                        <th>Lower</th>
                                        <th>Upper</th>
                                    </tr>
                                </thead>
                                <tbody id="weight-data">
                                    <tr>
                                        <td id="standard-weight">AUTO</td>
                                        <td id="standard-Lower">AUTO</td>
                                        <td id="standard-Upper">AUTO</td>
                                    </tr>
                                </tbody>
                            </table>
                        <div class="Report-section">
                            <h4 class="section-header">Detail Report</h4>
                                <div class="scrollable-box">
                                    <option value="" disabled selected>Line | Queue | D/C Part No. | Status </option>
                                    <select id="Report" class="list-box" size="4"></select>
                                    <script>
                                        async function fetchData() {
                                            const url = "https://script.google.com/macros/s/AKfycbwIQS6fV6WI4H4kjt0mr8QXLsDq5-vKs4tbqIJFaAb6IVvU5MY2-0YVd3nOurkfBy4p/exec";
                                            
                                            try {
                                                let response = await fetch(url);
                                                let data = await response.json();
    
                                                console.log("Data received:", data); // ✅ Debug JSON ที่ได้
    
                                                let listBox = document.getElementById("Report");
                                                listBox.innerHTML = ""; // ล้างค่าเก่า
    
                                                if (Array.isArray(data) && data.length > 0) {
                                                    data.forEach(item => {
                                                        let option = document.createElement("option");
                                                        option.value = item["Queue order"];
                                                        option.textContent = `${item["Where Line"]} | ${item["Queue order"]} | ${item["Part no."]} | ${item["Status"]}`;
                                                        listBox.appendChild(option);
                                                    });
                                                } else {
                                                    console.warn("No data found!");
                                                    let option = document.createElement("option");
                                                    option.textContent = "No data available";
                                                    listBox.appendChild(option);
                                                }
                                            } catch (error) {
                                                console.error("Error fetching data:", error);
                                            }
                                        }
    
                                        fetchData();
                                    </script>
                                </div>
                        </div>
                        </div>
                    </div>            
                </div>    
                <div class="container">
                    <div class="Detail-Weight-Box green-box">
                        <h3 class="section-header">Detail Wight (Box)</h3>
                        <div class="input-container">
                            <div>
                                <input type="text" class="box-input" placeholder="BOX1" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX2" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX3" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX4" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX5" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input" placeholder="BOX6" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX7" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX8" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX9" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX10" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input" placeholder="BOX11" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX12" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX13" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX14" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX15" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input" placeholder="BOX16" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX17" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX18" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX19" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX20" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input" placeholder="BOX21" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX22" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX23" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX24" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX25" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input" placeholder="BOX26" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX27" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX28" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX29" oninput="calculateAverage()"/>
                                <input type="text" class="box-input" placeholder="BOX30" oninput="calculateAverage()"/>
                            </div>
                        </div>
                    </div>
                    <div class="Detail-Weight-Part yellow-box">
                        <h3 class="section-header">Detail Weight (Part)</h3>
                        <div class="input-container">
                            <div>
                                <input type="text" class="box-input1" placeholder="BOX1" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX2" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX3" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX4" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX5" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input1" placeholder="BOX6" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX7" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX8" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX9" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX10" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input1" placeholder="BOX11" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX12" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX13" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX14" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX15" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input1" placeholder="BOX16" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX17" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX18" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX19" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX20" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input1" placeholder="BOX21" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX22" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX23" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX24" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX25" oninput="calculateAverage()"/>
                            </div>
                            <div>
                                <input type="text" class="box-input1" placeholder="BOX26" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX27" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX28" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX29" oninput="calculateAverage()"/>
                                <input type="text" class="box-input1" placeholder="BOX30" oninput="calculateAverage()"/>
                            </div>
                        </div> 
                    </div>
                    <div class="Detail-Material blue-box">
                        <h3 class="section-header">Detail Material (BOX)</h3>
                        <div class="input-container">
                            <!-- กรอบสี่เหลี่ยม -->
                            <div class="scrollable-box">
                                <option value="" disabled selected>Mat Code | Material | Q'TY </option>
                                <select id="materialList" class="list-box" onchange="handleMaterialSelection()" size="13">
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            <div class="logout-container">
                <a href="bin/login-page/Login.html" id="logoutLink" onclick="return confirm('Are you sure you want to log out?')" style="text-decoration: none;">
                    <button id="logoutButton">Logout</button>
                </a>
            </div>
            </div>                
        </div>
        <script src="dashboard.js"></script>
        <script src="app.js"></script>
        <script src="avatar.js"></script>
    </body>
    <footer>
        <p>&copy; 2025 SYSTEM Rev.1 All Rights Reserved.</p>
    </footer>
</html>
